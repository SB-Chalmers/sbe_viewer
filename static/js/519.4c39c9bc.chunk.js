"use strict";(self.webpackChunksbe_viewer=self.webpackChunksbe_viewer||[]).push([[519],{3519:(e,o,t)=>{t.r(o),t.d(o,{default:()=>R});var r=t(2483),a=t(4734),n=t(550),i=t(5470),l=t(4312),s=t(5555),c=t(7209),d=t(4664),h=t(1410),u=t(8970),x=t(8263),g=t(3130),v=t(8196),p=t(4682),m=t(5619);const b={p:2,width:"25vh",backgroundColor:"var(--bg-light)",color:"var(--text-light)","& .MuiTypography-root":{color:"var(--text-light)"},"& .MuiButton-root":{backgroundColor:"var(--button-primary)",color:"var(--button-text-primary)","&:hover":{backgroundColor:"var(--accent-hover)"},"&:active":{backgroundColor:"var(--accent-active)"},"&.Mui-disabled":{backgroundColor:"var(--accent-disabled)"}},"& .MuiSelect-root":{backgroundColor:"var(--bg-light-secondary)",color:"var(--text-light)"},"& .MuiMenuItem-root":{color:"var(--text-light)"},"& .MuiSlider-root":{color:"var(--slider-color)","& .MuiSlider-thumb":{"&:hover":{boxShadow:"0 0 0 8px var(--accent-hover)"}}},"& .MuiSwitch-root":{"& .MuiSwitch-track":{backgroundColor:"var(--text-light-secondary)"},"& .MuiSwitch-thumb":{backgroundColor:"var(--switch-color)"}},"& .MuiIconButton-root":{"&.active":{color:"var(--icon-active)"}}};var j=t(6723);const y=e=>{let{resetView:o}=e;return(0,j.jsxs)(a.A,{sx:b,children:[(0,j.jsx)(i.A,{variant:"h5",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Welcome to SBE Viewer"}),(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Use the Import Data tab to upload geoJSON files."}),(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Navigate through Layers to reorder, rename, or style your data."}),(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Adjust lighting in the Lighting tab."}),(0,j.jsx)(m.A,{variant:"contained",color:"primary",onClick:o,children:"Reset View"})]})};var A=t(146),C=t(792);const f={uploadHBJSON:`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_MAPBOX_ACCESS_TOKEN:""}.REACT_APP_API_URL||"http://localhost:3001"}/api/hbjson/upload`},S=()=>{const[e,o]=(0,r.useState)(null),[t,n]=(0,r.useState)(!1);return(0,j.jsxs)(a.A,{sx:b,children:[(0,j.jsx)(i.A,{variant:"h5",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Import Data"}),e&&(0,j.jsx)(A.A,{severity:"error",sx:{mb:2},children:e}),(0,j.jsxs)(a.A,{sx:{border:"2px dashed var(--upload-border)",p:2,textAlign:"center","&:hover":{borderColor:"var(--accent-hover)"},position:"relative"},children:[t&&(0,j.jsx)(a.A,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.7)"},children:(0,j.jsx)(C.A,{})}),(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Drag and drop your HBJSON files here"}),(0,j.jsxs)(m.A,{variant:"contained",component:"label",children:["Click to Upload",(0,j.jsx)("input",{type:"file",hidden:!0,onChange:async t=>{o(null),n(!0);const r=t.target.files;if(r&&r.length>0){const t=r[0];if(!t.name.toLowerCase().endsWith(".hbjson"))return o("Please upload a .hbjson file"),void n(!1);try{const e=new FormData;e.append("file",t);const o=await fetch(f.uploadHBJSON,{method:"POST",body:e});if(!o.ok){const e=await o.json().catch((()=>({})));throw new Error(e.message||`Upload failed with status: ${o.status}`)}const r=await o.json();console.log("File uploaded successfully:",r.filePath)}catch(e){console.error("Error handling file:",e),o(e instanceof Error?e.message:"Failed to process file")}finally{n(!1)}}else n(!1)}})]})]})]})};var w=t(3888),k=t(9908),E=t(3390),B=t(6253),M=t(4688),D=t(6247),O=t(6605),_=t(7636),P=t(5445),T=t(9253),I=t(2224),L=t(407);const W=e=>{let{layers:o,onVisibilityToggle:t,onColorByChange:n}=e;const[l,c]=(0,r.useState)(!0),[d,h]=(0,r.useState)(!1),[u,x]=(0,r.useState)("");return(0,j.jsxs)(a.A,{sx:b,children:[(0,j.jsx)(i.A,{variant:"h5",fontWeight:"bold",gutterBottom:!0,children:"Layer Management"}),(0,j.jsxs)(a.A,{mb:2,children:[(0,j.jsxs)(i.A,{variant:"h6",onClick:()=>c(!l),sx:{cursor:"pointer",display:"flex",alignItems:"center",fontWeight:"bold"},children:["Layer Visibility ",l?(0,j.jsx)(P.A,{}):(0,j.jsx)(T.A,{})]}),(0,j.jsx)(w.A,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,j.jsx)(s.A,{children:[{id:"buildings",name:"3D Buildings"},{id:"land-cover",name:"Ground Shadows"},{id:"tree-layer",name:"Tree Geometry Layer"},{id:"tree-points-layer",name:"Tree Points Layer"},{id:"hbjson-glb-layer",name:"HBJSON Layer"}].map((e=>{var r,a;return(0,j.jsxs)(k.Ay,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,j.jsx)(E.A,{primary:e.name,sx:{fontWeight:500}}),(0,j.jsx)(B.A,{onClick:()=>t(e.id),sx:{color:null!==(r=o.find((o=>o.id===e.id)))&&void 0!==r&&r.visible?"var(--icon-active)":"var(--text-light-secondary)"},children:null!==(a=o.find((o=>o.id===e.id)))&&void 0!==a&&a.visible?(0,j.jsx)(I.A,{}):(0,j.jsx)(L.A,{})})]},e.id)}))})})]}),(0,j.jsxs)(a.A,{children:[(0,j.jsxs)(i.A,{variant:"h6",onClick:()=>h(!d),sx:{cursor:"pointer",display:"flex",alignItems:"center",fontWeight:"bold"},children:["Buildings ",d?(0,j.jsx)(P.A,{}):(0,j.jsx)(T.A,{})]}),(0,j.jsx)(w.A,{in:d,timeout:"auto",unmountOnExit:!0,children:(0,j.jsxs)(M.A,{fullWidth:!0,margin:"normal",sx:{mt:2},children:[(0,j.jsx)(D.A,{sx:{mb:1,color:"var(--text-light)","&.Mui-focused":{color:"var(--text-light)"}},children:"Color By"}),(0,j.jsx)(O.A,{value:u,onChange:e=>{const o=e.target.value;console.log("Selected color by attribute:",o),x(o),n(o)},sx:{color:"var(--text-light)",backgroundColor:"var(--bg-light)","& .MuiOutlinedInput-notchedOutline":{borderColor:"var(--border-light)"},"& .MuiSvgIcon-root":{color:"var(--text-light)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"var(--accent-primary)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"var(--accent-primary)"}},MenuProps:{PaperProps:{sx:{backgroundColor:"var(--bg-light)",color:"var(--text-light)","& .MuiMenuItem-root":{color:"var(--text-light)","&:hover":{backgroundColor:"var(--bg-light-secondary)"},"&.Mui-selected":{backgroundColor:"var(--accent-primary)",color:"var(--button-text-primary)","&:hover":{backgroundColor:"var(--accent-hover)"}}}}}},children:["type","status","height","function","floors","floor_height","roof_type","EPC_class","annual_energy","area"].map((e=>(0,j.jsx)(_.A,{value:e,children:e},e)))})]})})]})]})},F=e=>{let{onBasemapChange:o}=e;const[t,n]=(0,r.useState)("mapbox://styles/mapbox/light-v10");return(0,j.jsxs)(a.A,{sx:b,children:[(0,j.jsx)(i.A,{variant:"h5",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Basemap Selection"}),(0,j.jsx)(O.A,{fullWidth:!0,value:t,onChange:e=>{const t=e.target.value;n(t),o(t)},sx:{backgroundColor:"#FFFFFF",color:"#1E1E2D"},MenuProps:{PaperProps:{style:{maxHeight:200,overflow:"auto"}}},children:[{id:"mapbox://styles/mapbox/light-v10",name:"Light"},{id:"mapbox://styles/mapbox/satellite-v9",name:"Satellite"},{id:"mapbox://styles/mapbox/outdoors-v11",name:"Terrain"},{id:"mapbox://styles/mapbox/streets-v11",name:"Streets"},{id:"mapbox://styles/mapbox/dark-v10",name:"Dark"}].map((e=>(0,j.jsx)(_.A,{value:e.id,children:e.name},e.id)))})]})};var H=t(6792),V=t(6295);const N=()=>{const[e,o]=r.useState(!0),[t,n]=r.useState(50),[l,s]=r.useState(50),[c,d]=r.useState(50),h=e=>(o,t)=>{e(t)};return(0,j.jsxs)(a.A,{sx:b,children:[(0,j.jsx)(i.A,{variant:"h5",gutterBottom:!0,sx:{color:"#1E1E2D"},children:"Lighting Setup"}),(0,j.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,children:"Sunlight"}),(0,j.jsx)(H.A,{checked:e,onChange:()=>{o(!e)}})]}),(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,children:"Sun Color"}),(0,j.jsx)(V.Ay,{value:t,onChange:h(n)}),(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,children:"Diffuse Color"}),(0,j.jsx)(V.Ay,{value:l,onChange:h(s)}),(0,j.jsx)(i.A,{variant:"body1",gutterBottom:!0,children:"Shadow Color"}),(0,j.jsx)(V.Ay,{value:c,onChange:h(d)})]})},R=e=>{let{resetView:o,onBasemapChange:t,layers:m,onVisibilityToggle:b,onColorByChange:A,onAddLayer:C}=e;const[f,w]=(0,r.useState)(0),[k,E]=(0,r.useState)("mapbox://styles/mapbox/light-v10"),B=[{component:(0,j.jsx)(y,{resetView:o}),icon:(0,j.jsx)(u.A,{fontSize:"large"}),tooltip:"Home"},{component:(0,j.jsx)(S,{}),icon:(0,j.jsx)(x.A,{fontSize:"large"}),tooltip:"Import Data"},{component:(0,j.jsx)(W,{layers:m,onVisibilityToggle:b,onColorByChange:A}),icon:(0,j.jsx)(g.A,{fontSize:"large"}),tooltip:"Layer Management"},{component:(0,j.jsx)(F,{onBasemapChange:e=>{E(e),t(e)}}),icon:(0,j.jsx)(v.A,{fontSize:"large"}),tooltip:"Basemap"},{component:(0,j.jsx)(N,{}),icon:(0,j.jsx)(p.A,{fontSize:"large"}),tooltip:"Lighting"}];return(0,j.jsxs)(a.A,{sx:{display:"flex",backgroundColor:"var(--bg-light)",minHeight:"100vh"},children:[(0,j.jsxs)(n.Ay,{variant:"permanent",anchor:"left",sx:{width:70,flexShrink:0,"& .MuiDrawer-paper":{width:70,boxSizing:"border-box",backgroundColor:"var(--drawer-background)",color:"var(--drawer-text)",overflowX:"hidden",position:"relative",height:"100%"}},children:[(0,j.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:1},children:(0,j.jsx)(i.A,{variant:"h6",noWrap:!0,sx:{color:"var(--drawer-text)",ml:1},children:"SBE"})}),(0,j.jsx)(l.A,{sx:{backgroundColor:"var(--drawer-divider)"}}),(0,j.jsx)(s.A,{children:B.map(((e,o)=>(0,j.jsx)(c.A,{title:e.tooltip,placement:"right",children:(0,j.jsx)(d.A,{selected:f===o,onClick:()=>(e=>{w(e)})(o),disableGutters:!0,sx:{justifyContent:"center"},children:(0,j.jsx)(h.A,{sx:{color:"var(--drawer-text)",minWidth:"auto"},children:e.icon})})},o)))}),(0,j.jsx)(l.A,{sx:{backgroundColor:"var(--drawer-divider)"}})]}),(0,j.jsx)(a.A,{component:"main",sx:{flexGrow:1,p:3,backgroundColor:"var(--bg-light)",minHeight:"100vh"},children:B[f].component})]})}}}]);
//# sourceMappingURL=519.4c39c9bc.chunk.js.map